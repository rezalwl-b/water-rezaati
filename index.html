<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ÛŒØ§Ø¯Ø¢ÙˆØ± Û¸ Ù„ÛŒÙˆØ§Ù† Ø¢Ø¨ â€” Ù†ÙˆØ´ÛŒØ¯Ù† Ø¢Ø¨</title>
  <style>
    :root{
      --bg:#E9F7FF;--card:#ffffff;--accent:#2aa7ff;--glass-border:#c6e7ff;--water:#7fd3ff;--muted:#6b6b6b;
      font-family:'Vazirmatn',system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#f8ffff)}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:2rem}
    .card{width:100%;max-width:1000px;background:var(--card);border-radius:20px;box-shadow:0 10px 30px rgba(60,120,150,.12);padding:28px;display:grid;grid-template-columns:1fr 380px;gap:20px;align-items:start}

    h1{margin:0 0 6px 0;font-size:20px;text-align:right}
    p.lead{margin:0 0 18px 0;color:var(--muted);text-align:right}

    .glasses{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    .glass{background:linear-gradient(180deg,rgba(255,255,255,.8),rgba(255,255,255,.6));border-radius:14px;padding:10px;border:2px solid var(--glass-border);display:flex;flex-direction:column;align-items:center;justify-content:flex-end;cursor:pointer;transition:transform .18s ease,box-shadow .18s}
    .glass:active{transform:scale(.98)}
    .glass .cup{width:100%;height:120px;border-radius:10px;position:relative;overflow:hidden;background:rgba(255,255,255,.5);display:flex;align-items:flex-end;justify-content:center}
    .water{position:absolute;left:0;right:0;bottom:0;height:0%;background:linear-gradient(180deg,var(--water),#56b8f0);transition:height .6s cubic-bezier(.2,.9,.3,1)}
    .label{margin-top:10px;font-weight:600;color:#0b6aa6}
    .glass.filled{box-shadow:0 8px 18px rgba(34,149,214,.12);border-color:rgba(42,167,255,.6)}

    .side{display:flex;flex-direction:column;gap:16px;align-items:stretch}
    .stage{display:flex;align-items:center;justify-content:center;min-height:220px;background:linear-gradient(180deg,#eafff1,#f6fff6);border:1px solid rgba(120,210,140,.18);border-radius:16px}
    .char-img{width:220px;height:220px;border-radius:12px;transition:transform .35s ease;object-fit:contain}
    .char-img.happy{transform:translateY(-6px) scale(1.05)}

    .meter{width:100%;height:12px;background:linear-gradient(90deg,#e6f7ff,#e6fff6);border-radius:10px;overflow:hidden}
    .meter>i{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#7fe1a3);transition:width .6s cubic-bezier(.2,.9,.3,1)}

    .controls{display:flex;gap:8px}
    button{appearance:none;border:0;padding:10px 12px;border-radius:10px;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
    button.ghost{background:transparent;color:var(--muted);border:1px solid #dfeffb}

    .char-picker{display:flex;gap:8px;flex-wrap:wrap}
    .char-card{display:flex;align-items:center;gap:8px;border:1px solid #e6eef7;border-radius:12px;padding:8px 10px;cursor:pointer;user-select:none}
    .char-card input{accent-color:var(--accent)}

    .toast{position:fixed;left:50%;top:18px;transform:translateX(-50%);background:#0b6aa6;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 10px 24px rgba(0,0,0,.12);opacity:0;pointer-events:none;transition:opacity .25s ease}
    .toast.show{opacity:1}

    #confetti{position:fixed;inset:0;pointer-events:none;z-index:10}
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <div class="toast" id="toast"></div>
  <div class="wrap">
    <div class="card">
      <div>
        <h1>ÛŒØ§Ø¯Ø¢ÙˆØ± Ù†ÙˆØ´ÛŒØ¯Ù† Ø±ÙˆØ²ÛŒ Û¸ Ù„ÛŒÙˆØ§Ù† Ø¢Ø¨</h1>
        <p class="lead">Ù‡Ø± Ù„ÛŒÙˆØ§Ù† Ø±Ø§ Ú©Ù‡ Ù†ÙˆØ´ÛŒØ¯ÛŒ Ø¨Ø²Ù† Ø±ÙˆÛŒØ´ ØªØ§ Ù¾Ø± Ø´ÙˆØ¯ â€” Ø¢Ù‚Ø§ÛŒ Ø±Ø¶Ø§Ø¹ØªÛŒ (ÛŒÚ©ÛŒ Ø§Ø² Ø­ÛŒÙˆØ§Ù†Ø§Øª Ù…Ø§) Ø®ÙˆØ´Ø­Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯!</p>
        <div class="glasses" id="glasses"></div>
        <div style="margin-top:16px;display:flex;gap:10px;justify-content:flex-end;align-items:center">
          <div style="text-align:right"><div style="font-size:13px;color:var(--muted)">Ù†ÙˆØ´ÛŒØ¯Ù‡ Ø´Ø¯Ù‡</div><div id="count" style="font-weight:800;font-size:18px">0 / 8</div></div>
          <div style="flex:1"></div>
          <div class="controls">
            <button id="reset">ØªÙ†Ø¸ÛŒÙ… Ù…Ø¬Ø¯Ø¯</button>
          </div>
        </div>
      </div>
      <aside class="side">
        <div class="stage" id="stage"></div>
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
          <div style="font-weight:800">Ù¾ÛŒØ´Ø±ÙØª Ø±ÙˆØ²</div>
          <div class="meter" style="flex:1"><i id="meterBar"></i></div>
        </div>
        <div>
          <div style="font-weight:700;margin:6px 0 8px">Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø®ØµÛŒØª Ø¢Ù‚Ø§ÛŒ Ø±Ø¶Ø§Ø¹ØªÛŒ ğŸ¾</div>
          <div class="char-picker" id="charPicker"></div>
        </div>
      </aside>
    </div>
  </div>
<script>
const CHARACTERS = {
  cat:{name:'Ú¯Ø±Ø¨Ù‡',src:'https://cdn-icons-png.flaticon.com/512/616/616408.png'},
  dog:{name:'Ø³Ú¯',src:'https://cdn-icons-png.flaticon.com/512/616/6164089.png'},
  cow:{name:'Ú¯Ø§Ùˆ',src:'https://cdn-icons-png.flaticon.com/512/1998/1998610.png'},
  lion:{name:'Ø´ÛŒØ±',src:'https://cdn-icons-png.flaticon.com/512/616/616431.png'},
  panda:{name:'Ù¾Ø§Ù†Ø¯Ø§',src:'https://cdn-icons-png.flaticon.com/512/616/6164084.png'}
};
let selected='cat';
const state=JSON.parse(localStorage.getItem('drinkState')||'[]').length?JSON.parse(localStorage.getItem('drinkState')):Array(8).fill(false);
function save(){localStorage.setItem('drinkState',JSON.stringify(state));localStorage.setItem('char',selected)}
function showToast(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1500)}
function cheer(){const img=document.querySelector('.char-img');img.classList.add('happy');setTimeout(()=>img.classList.remove('happy'),700)}
function update(){const done=state.filter(Boolean).length;document.getElementById('count').textContent=`${done} / 8`;document.getElementById('meterBar').style.width=`${(done/8)*100}%`;if(done===8)confetti();}
function toggle(i,el){state[i]=!state[i];el.classList.toggle('filled');el.querySelector('.water').style.height=state[i]?'85%':'0%';save();cheer();showToast(`Ø¢Ù‚Ø§ÛŒ Ø±Ø¶Ø§Ø¹ØªÛŒ (${CHARACTERS[selected].name}) Ø®ÙˆØ´Ø­Ø§Ù„ Ø´Ø¯!`);update();}
function loadChar(){selected=localStorage.getItem('char')||'cat';renderCharPicker();renderStage();}
function renderCharPicker(){const p=document.getElementById('charPicker');p.innerHTML='';for(const [k,v] of Object.entries(CHARACTERS)){const l=document.createElement('label');l.className='char-card';l.innerHTML=`<input type='radio' name='char' value='${k}' ${selected===k?'checked':''}>${v.name}`;l.querySelector('input').onchange=()=>{selected=k;save();renderStage();};p.append(l)}}
function renderStage(){const s=document.getElementById('stage');s.innerHTML='';const img=document.createElement('img');img.src=CHARACTERS[selected].src;img.className='char-img';s.append(img);}
function confetti(){const canvas=document.getElementById('confetti');const ctx=canvas.getContext('2d');canvas.width=innerWidth;canvas.height=innerHeight;const colors=['#2aa7ff','#7fe1a3','#ffd166','#ef476f','#8338ec'];const pieces=Array.from({length:150},()=>({x:Math.random()*innerWidth,y:Math.random()*-innerHeight,vx:-2+Math.random()*4,vy:2+Math.random()*3,color:colors[Math.floor(Math.random()*colors.length)],r:Math.random()*2*Math.PI,vr:-.2+Math.random()*.4,w:5+Math.random()*5,h:8+Math.random()*10}));const t0=performance.now();(function draw(t){ctx.clearRect(0,0,canvas.width,canvas.height);for(const p of pieces){p.y+=p.vy;p.x+=p.vx;p.r+=p.vr;if(p.y>canvas.height)p.y=-10;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.r);ctx.fillStyle=p.color;ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);ctx.restore();}if(t-t0<4000)requestAnimationFrame(draw)})();showToast('Û¸ Ù„ÛŒÙˆØ§Ù† Ú©Ø§Ù…Ù„ Ø´Ø¯ ğŸ‰');}
// glasses
const g=document.getElementById('glasses');for(let i=0;i<8;i++){const b=document.createElement('button');b.className='glass'+(state[i]?' filled':'');b.innerHTML=`<div class='cup'><div class='water' style='height:${state[i]?'85%':'0%'}'></div></div><div class='label'>Ù„ÛŒÙˆØ§Ù† ${i+1}</div>`;b.onclick=()=>toggle(i,b);g.append(b)}
loadChar();update();
// hourly notification
if('Notification'in window){Notification.requestPermission().then(p=>{if(p==='granted'){setInterval(()=>{const done=state.filter(Boolean).length;if(done<8)new Notification('ÛŒØ§Ø¯Ø¢ÙˆØ± Ø¢Ø¨ ğŸ’§',{body:`Ø¢Ù‚Ø§ÛŒ Ø±Ø¶Ø§Ø¹ØªÛŒ (${CHARACTERS[selected].name}) Ù…Ù†ØªØ¸Ø± Ù„ÛŒÙˆØ§Ù† Ø¨Ø¹Ø¯ÛŒ Ø§Ø³Øª!`})},3600000)}})}
</script>
</body>
</html>
